## Description
The page contains reproducible code for MNIST experiments. The network archetecture could be referred in Figure 3 in our paper.
The trained model is also provided in google-drive.

## Defense Types for Adverserial Training

|Command  | Description |
|-----------| :---------------------: | 
| pgd_main     | Adv Images Generated By Main Branch Loss| 
| pgd_avg      | Adv Images Generated By Average Loss| 
| pgd_max      | Adv Images Generated By Branch Images Whose Loss Is Maxmizing Average Loss| 


### Train Network
```
python3 train.py train mnist_smallcnn -d MNIST --attack_algo pgd_avg --defend_algo pgd_max --save-folder branch_adv_max
```
Trainig on Small-CNN BackBone with Defense Type = pgd_max. Using pgd_avg algorithm for the evalution of each branch indivisually. The default defense setting is PGD-40 with eps = 0.3 and sigma = 0.01. The default attack setting is PGD-40 with eps = 0.3 and sigma = 0.01.


### Evaluate Network
```
python3 train.py test mnist_smallcnn -d MNIST --resume `model_path`
```

The default attack setting is PGD-40 with eps = 0.3 and sigma = 0.01. Average Loss Attack, Individual Branch Attack, Max-Average Loss Attack will perform in this stage.

[Note] We provide the best thredsholds for our pre-trained model. One might need to adjust thredsholds on his own for better performance.

